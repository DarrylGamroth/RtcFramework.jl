        - using Aeron
        - using Clocks
        - 
        - """
        - Test suite for stream adapter functionality.
        - Tests ControlStreamAdapter and InputStreamAdapter operations.
        - """
        1 function test_adapters(client)
        1     @testset "ControlStreamAdapter" begin
        3         clock = CachedEpochClock(EpochClock())
        1         properties = TestAgent.Properties(clock)
        1         comms = CommunicationResources(client, properties)
        1         base_agent = BaseRtcAgent(comms, properties, clock)
        1         agent = TestAgent.RtcAgent(base_agent)
        - 
        -         # Test adapter creation
        1         adapter = RtcFramework.ControlStreamAdapter(comms.control_stream, agent)
        1         @test adapter isa RtcFramework.ControlStreamAdapter
        2         @test !isnothing(adapter.subscription)
        2         @test !isnothing(adapter.assembler)
        - 
        -         # Test polling (should return 0 in empty test environment)
        1         fragments_read = RtcFramework.poll(adapter, 10)
        1         @test fragments_read isa Int
        1         @test fragments_read == 0
        -     end
        - 
        -     @testset "InputStreamAdapter" begin
        3         clock = CachedEpochClock(EpochClock())
        1         properties = TestAgent.Properties(clock)
        1         comms = CommunicationResources(client, properties)
        1         base_agent = BaseRtcAgent(comms, properties, clock)
        1         agent = TestAgent.RtcAgent(base_agent)
        - 
        -         # Test single adapter creation and operation
        1         if !isempty(comms.input_streams)
        0             adapter = RtcFramework.InputStreamAdapter(comms.input_streams[1], agent)
        0             @test adapter isa RtcFramework.InputStreamAdapter
        0             @test !isnothing(adapter.subscription)
        0             @test !isnothing(adapter.assembler)
        - 
        -             # Test polling (should return 0 in empty test environment)
        0             fragments_read = RtcFramework.poll(adapter, 10)
        0             @test fragments_read isa Int
        0             @test fragments_read == 0
        -         end
        - 
        -         # Test multiple adapter creation and polling
        1         adapters = RtcFramework.InputStreamAdapter[]
        1         for stream in comms.input_streams
        0             push!(adapters, RtcFramework.InputStreamAdapter(stream, agent))
        0         end
        - 
        -         # Test vector polling
        1         total_fragments = RtcFramework.poll(adapters, 10)
        1         @test total_fragments isa Int
        1         @test total_fragments == 0
        - 
        -         # Test empty adapter vector
        1         empty_adapters = RtcFramework.InputStreamAdapter[]
        1         @test RtcFramework.poll(empty_adapters, 10) == 0
        -     end
        - 
        -     @testset "CommunicationResources" begin
        3         clock = CachedEpochClock(EpochClock())
        1         properties = TestAgent.Properties(clock)
        - 
        -         # Test construction
        1         comms = CommunicationResources(client, properties)
        1         @test comms isa CommunicationResources
        2         @test !isnothing(comms.status_stream)
        2         @test !isnothing(comms.control_stream)
        1         @test comms.input_streams isa Vector{Aeron.Subscription}
        1         @test comms.output_streams isa Vector{Aeron.ExclusivePublication}
        - 
        -         # Test that streams are created according to properties
        1         @test comms.status_stream isa Aeron.ExclusivePublication
        1         @test comms.control_stream isa Aeron.Subscription
        - 
        -         # Test that streams are properly initialized (not closed)
        2         @test isopen(comms.status_stream)
        2         @test isopen(comms.control_stream)
        - 
        -         # Test close functionality
        1         @test_nowarn close(comms)
        -     end
        - 
        -     @testset "Agent Adapter Integration" begin
        2         clock = CachedEpochClock(EpochClock())
        1         properties = TestAgent.Properties(clock)
        1         comms = CommunicationResources(client, properties)
        1         base_agent = BaseRtcAgent(comms, properties, clock)
        1         agent = TestAgent.RtcAgent(base_agent)
        - 
        -         # Test initial state
        1         @test base(agent).control_adapter === nothing
        1         @test isempty(base(agent).input_adapters)
        - 
        -         # Test adapter creation via Agent.on_start
        1         Agent.on_start(agent)
        4         @test !isnothing(base(agent).control_adapter)
        1         @test base(agent).control_adapter isa RtcFramework.ControlStreamAdapter
        1         @test length(base(agent).input_adapters) == length(comms.input_streams)
        2         @test all(adapter -> adapter isa RtcFramework.InputStreamAdapter, base(agent).input_adapters)
        - 
        -         # Test adapter polling via agent pollers
        1         @test RtcFramework.control_poller(agent) == 0
        1         @test RtcFramework.input_poller(agent) == 0
        - 
        -     # Test adapter cleanup via state machine then Agent
        3     @test_throws AgentTerminationException dispatch!(agent, :Exit)
        1         Agent.on_close(agent)
        1         @test base(agent).control_adapter === nothing
        1         @test isempty(base(agent).input_adapters)
        -     end
        - end
